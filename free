local key_url = "https://raw.githubusercontent.com/c5least011/Tsb-Vip/refs/heads/main/key"

local p = game.Players.LocalPlayer
local running = false

local function getKey()
    local success, res = pcall(function()
        return game:HttpGet(key_url)
    end)
    return success and res:match("^%s*(.-)%s*$") or nil
end

local function getRandomPlayer()
    local players = {}
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= p and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            table.insert(players, v)
        end
    end
    return #players > 0 and players[math.random(1, #players)] or nil
end

local function getRandomEnemy()
    local players = {}
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= p and v.Team ~= p.Team and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            table.insert(players, v)
        end
    end
    return #players > 0 and players[math.random(1, #players)] or nil
end

local function followPlayers()
    running = true
    while running do
        local target = getRandomPlayer()
        if not target then task.wait(1) continue end

        repeat  
            if not running then return end  
            if target.Character and target.Character:FindFirstChild("HumanoidRootPart") and p.Character then  
                p.Character:WaitForChild("HumanoidRootPart").CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)  
            else  
                break  
            end  
            task.wait(0.001)  
        until not target.Character or not target.Character.Parent  
    end
end

local function followEnemies()
    running = true
    while running do
        local target = getRandomEnemy()
        if not target then task.wait(1) continue end

        repeat  
            if not running then return end  
            if target.Character and target.Character:FindFirstChild("HumanoidRootPart") and p.Character then  
                p.Character:WaitForChild("HumanoidRootPart").CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)  
            else  
                break  
            end  
            task.wait(0.001)  
        until not target.Character or not target.Character.Parent  
    end
end

local gui = Instance.new("ScreenGui", game.CoreGui)

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 200, 0, 180)
frame.Position = UDim2.new(0.5, -100, 0.5, -90)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.Active = true
frame.Draggable = true
frame.Visible = false

local playersBtn = Instance.new("TextButton", frame)
playersBtn.Size = UDim2.new(0, 180, 0, 30)
playersBtn.Position = UDim2.new(0, 10, 0, 40)
playersBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
playersBtn.Text = "Players"

local duelBtn = Instance.new("TextButton", frame)
duelBtn.Size = UDim2.new(0, 180, 0, 30)
duelBtn.Position = UDim2.new(0, 10, 0, 80)
duelBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
duelBtn.Text = "Players (Duel) [Beta]"

local stopBtn = Instance.new("TextButton", frame)
stopBtn.Size = UDim2.new(0, 180, 0, 30)
stopBtn.Position = UDim2.new(0, 10, 0, 160)
stopBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
stopBtn.Text = "Stop"

playersBtn.MouseButton1Click:Connect(function()
    running = false
    task.wait(0.2)
    task.spawn(followPlayers)
end)

duelBtn.MouseButton1Click:Connect(function()
    running = false
    task.wait(0.2)
    task.spawn(followEnemies)
end)

stopBtn.MouseButton1Click:Connect(function()
    running = false
end)
